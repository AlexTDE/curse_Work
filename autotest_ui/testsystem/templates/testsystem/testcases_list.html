{% extends 'testsystem/base.html' %}

{% block title %}–¢–µ—Å—Ç-–∫–µ–π—Å—ã - –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è UI{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
        <h2>üìù –¢–µ—Å—Ç-–∫–µ–π—Å—ã</h2>
        <a href="{% url 'index' %}" class="btn btn-secondary">‚Üê –ù–∞–∑–∞–¥</a>
    </div>
    
    <div style="margin-bottom: 20px;">
        <h3 style="margin-bottom: 15px;">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–µ—Å—Ç-–∫–µ–π—Å</h3>
        <form method="post" action="{% url 'create_testcase' %}" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="form-group">
                <label>–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                <input type="text" name="title" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞">
            </div>
            <div class="form-group">
                <label>–û–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                <textarea name="description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç-–∫–µ–π—Å–∞"></textarea>
            </div>
            <div class="form-group">
                <label>–≠—Ç–∞–ª–æ–Ω–Ω—ã–π —Å–∫—Ä–∏–Ω—à–æ—Ç:</label>
                <input type="file" name="reference_screenshot" accept="image/*" required>
            </div>
            <button type="submit" class="btn btn-success">‚úÖ –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç-–∫–µ–π—Å</button>
        </form>
    </div>
    
    <hr style="margin: 30px 0; border: none; border-top: 2px solid #f0f0f0;">
    
    <h3 style="margin-bottom: 15px;">–í—Å–µ —Ç–µ—Å—Ç-–∫–µ–π—Å—ã</h3>
    {% if testcases %}
    <table class="table">
        <thead>
            <tr>
                <th>ID</th>
                <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–≠–ª–µ–º–µ–Ω—Ç–æ–≤</th>
                <th>–ü—Ä–æ–≥–æ–Ω–æ–≤</th>
                <th>–°–æ–∑–¥–∞–Ω</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
        </thead>
        <tbody>
            {% for tc in testcases %}
            <tr>
                <td>{{ tc.id }}</td>
                <td><a href="{% url 'testcase_detail' tc.id %}">{{ tc.title }}</a></td>
                <td><span class="badge badge-{{ tc.status }}">{{ tc.get_status_display }}</span></td>
                <td>{{ tc.elements.count }}</td>
                <td>{{ tc.runs.count }}</td>
                <td>{{ tc.created_at|date:"d.m.Y H:i" }}</td>
                <td>
                    <div style="display: flex; gap: 5px;">
                        {% if tc.status == 'new' %}
                        <form method="post" action="{% url 'analyze_testcase' tc.id %}" style="display: inline;">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-info btn-small">üîç –ê–Ω–∞–ª–∏–∑</button>
                        </form>
                        {% endif %}
                        <a href="{% url 'testcase_detail' tc.id %}" class="btn btn-secondary btn-small">üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä</a>
                        <form method="post" action="{% url 'delete_testcase' tc.id %}" style="display: inline;" onsubmit="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —Ç–µ—Å—Ç-–∫–µ–π—Å \"{{ tc.title }}\"? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!');">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-danger btn-small">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                        </form>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p style="color: #666; text-align: center; padding: 40px;">–ù–µ—Ç —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π –≤—ã—à–µ.</p>
    {% endif %}
</div>
{% endblock %}

